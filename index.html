<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title> SIGA System</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div id="configMissing" class="config-missing" hidden>
    Missing `firebase-config.js`. Copy `firebase-config.example.js` and fill in your Firebase values.
  </div>
  <div class="app">

    <!-- HEADER / BRANDING -->
    <header class="app-header">
      <div class="branding-row">

        <div class="brand-left">
          <!-- Minimalist SVG logo -->
          <svg class="logo" width="32" height="32" viewBox="0 0 100 100" aria-hidden="true">
            <circle cx="50" cy="50" r="46" stroke="currentColor" stroke-width="6" fill="none"/>
            <path d="M30 55 L45 70 L75 35"
                  stroke="currentColor"
                  stroke-width="8"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"/>
          </svg>

          <div class="brand-text">
            <h1> SIGA System</h1>
            <div class="made-by">Made by Alex</div>
          </div>
        </div>

        <div class="header-actions">
          <div class="sync-controls">
            <div id="syncStatus" class="sync-status" aria-live="polite">Local</div>
            <button id="syncRefreshBtn" class="icon-btn sync-refresh-btn" type="button" aria-label="Refresh sync" title="Refresh sync">
              ↻
            </button>
          </div>
          <button id="themeToggleBtn" class="icon-btn theme-toggle-btn" aria-label="Toggle dark mode">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 1 0 9.79 9.79Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <div class="account-wrap">
            <button
              id="accountChip"
              class="account-chip"
              type="button"
              aria-haspopup="true"
              aria-expanded="false"
              aria-controls="accountMenu"
            >
              Sign in →
            </button>
            <div id="accountMenu" class="account-menu" hidden role="menu">
              <button type="button" id="accountMenuSignOut" role="menuitem">Sign out</button>
              <button type="button" id="accountMenuCopyEmail" role="menuitem">Copy email</button>
            </div>
          </div>
        </div>
      </div>

      <p class="subtitle">Categories, due dates &amp; your daily system.</p>
    </header>

    <!-- ADD TASK FORM -->
    <form id="addForm" autocomplete="off">
      <input id="taskInput" type="text" placeholder="What do you need to do?" />
      <select id="categorySelect">
        <option value="General">General</option>
        <option value="Home">Home</option>
        <option value="Work">Work</option>
        <option value="Personal">Personal</option>
      </select>
      <input id="dueInput" type="date" />
      <button type="submit" class="primary">+ Add</button>

      <label class="daily-toggle">
        <input id="dailyInput" type="checkbox" />
        <span>Daily task</span>
      </label>
    </form>

    <!-- FILTERS + SORTING TOOLBAR -->
    <button
      id="viewOptionsBtn"
      class="view-options-btn"
      type="button"
      aria-expanded="false"
      aria-controls="toolbar"
    >
      View options
    </button>
    <div id="toolbar" class="toolbar">

      <!-- STATUS FILTERS -->
      <div class="filter-group">
        <div class="filter-group-label">Status</div>
        <div class="filters">
          <button class="chip active" data-filter="all">All</button>
          <button class="chip" data-filter="active">Active</button>
          <button class="chip" data-filter="done">Done</button>
        </div>
      </div>

      <!-- CATEGORY FILTERS + DAILY DRAWER BUTTON -->
      <div class="filter-group">
        <div class="filter-group-label">Category</div>
        <div class="category-filters">
          <button class="chip active" data-category="all"><span class="dot"></span> All</button>
          <button class="chip category-General" data-category="General"><span class="dot"></span> General</button>
          <button class="chip category-Home" data-category="Home"><span class="dot"></span> Home</button>
          <button class="chip category-Work" data-category="Work"><span class="dot"></span> Work</button>
          <button class="chip category-Personal" data-category="Personal"><span class="dot"></span> Personal</button>
          <button class="chip" id="openDailyDrawerBtn"><span class="dot"></span> Daily →</button>
          <button id="openWorkingDrawerBtn" class="chip">Working on <span id="workingCount" class="badge">0</span></button>
        </div>
      </div>

      <!-- SORTING MENU -->
      <div class="filter-group sort-group">
        <div class="filter-group-label">Sort</div>
        <select id="sortSelect" class="sort-select">
          <option value="manual">Manual (drag)</option>
          <option value="dueAsc">Due date ↑</option>
          <option value="dueDesc">Due date ↓</option>
          <option value="newest">Newest → oldest</option>
          <option value="oldest">Oldest → newest</option>
          <option value="alpha">A → Z</option>
          <option value="dailyTop">Daily on top</option>
        </select>
      </div>

      <!-- SUMMARY -->
      <div class="summary">
        <span id="count">0</span> total · <span id="activeCount">0</span> active
      </div>
    </div>

    <!-- MAIN LIST -->
    <ul id="list"></ul>

    <!-- FOOTER -->
    <div class="footer">
      <button id="clearDone" class="link-btn">Clear completed</button>
    </div>

    <div id="debugPanel" class="debug-panel" aria-live="polite" hidden></div>
  </div>

  <!-- DAILY DRAWER -->
  <div id="dailyDrawer" class="daily-drawer">
    <div class="daily-drawer-header">
      <h2>Daily Tasks</h2>
      <button id="closeDailyDrawer" class="icon-btn" aria-label="Close daily tasks">×</button>
    </div>
    <ul id="dailyDrawerList"></ul>
  </div>

  <!-- WORKING (Doing) DRAWER -->
  <div id="workingDrawer" class="daily-drawer">
    <div class="daily-drawer-header">
      <h2>What I'm working on</h2>
      <button id="closeWorkingDrawer" class="icon-btn" aria-label="Close working tasks">×</button>
    </div>
    <ul id="workingDrawerList"></ul>
  </div>

  <!-- Sortable.js for drag & drop -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script>
    fetch("./firebase-config.js", { method: "HEAD" })
      .then(r => {
        if (!r.ok) throw new Error("missing");
      })
      .catch(() => {
        const el = document.getElementById("configMissing");
        if (el) el.hidden = false;
      });
  </script>
  <script type="module" src="./main.js"></script>
</body>
</html>
